import{c as L,g as N}from"./index-CazbUZ7k.js";function U(D,I){for(var w=0;w<I.length;w++){const y=I[w];if(typeof y!="string"&&!Array.isArray(y)){for(const m in y)if(m!=="default"&&!(m in D)){const R=Object.getOwnPropertyDescriptor(y,m);R&&Object.defineProperty(D,m,R.get?R:{enumerable:!0,get:()=>y[m]})}}}return Object.freeze(Object.defineProperty(D,Symbol.toStringTag,{value:"Module"}))}function F(D){throw new Error('Could not dynamically require "'+D+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var M={exports:{}},H=M.exports,x;function W(){return x||(x=1,(function(D,I){var w=w||{};w.scope={},w.ASSUME_ES5=!1,w.ASSUME_NO_NATIVE_MAP=!1,w.ASSUME_NO_NATIVE_SET=!1,w.defineProperty=w.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(y,m,R){y!=Array.prototype&&y!=Object.prototype&&(y[m]=R.value)},w.getGlobal=function(y){return typeof window<"u"&&window===y?y:typeof L<"u"&&L!=null?L:y},w.global=w.getGlobal(H),w.polyfill=function(y,m,R,S){if(m){for(R=w.global,y=y.split("."),S=0;S<y.length-1;S++){var C=y[S];C in R||(R[C]={}),R=R[C]}y=y[y.length-1],S=R[y],m=m(S),m!=S&&m!=null&&w.defineProperty(R,y,{configurable:!0,writable:!0,value:m})}},w.polyfill("Object.setPrototypeOf",function(y){return y||(typeof"".__proto__!="object"?null:function(m,R){if(m.__proto__=R,m.__proto__!==R)throw new TypeError(m+" is not extensible");return m})},"es6","es5"),w.objectCreate=w.ASSUME_ES5||typeof Object.create=="function"?Object.create:function(y){var m=function(){};return m.prototype=y,new m},w.construct=typeof Reflect<"u"&&Reflect.construct||function(y,m,R){return R===void 0&&(R=y),R=w.objectCreate(R.prototype||Object.prototype),Function.prototype.apply.call(y,R,m)||R},w.polyfill("Reflect.construct",function(y){return y||w.construct},"es6","es3"),(function(y){D.exports=y()})(function(){return(function(){function y(m,R,S){function C(l,a){if(!R[l]){if(!m[l]){var f=typeof F=="function"&&F;if(!a&&f)return f(l,!0);if(T)return T(l,!0);throw a=Error("Cannot find module '"+l+"'"),a.code="MODULE_NOT_FOUND",a}a=R[l]={exports:{}},m[l][0].call(a.exports,function(g){return C(m[l][1][g]||g)},a,a.exports,y,m,R,S)}return R[l].exports}for(var T=typeof F=="function"&&F,p=0;p<S.length;p++)C(S[p]);return C}return y})()({1:[function(y,m,R){},{}],2:[function(y,m,R){m.exports=XMLHttpRequest},{}],3:[function(y,m,R){function S(i){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(i)}function C(i,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function T(i,e,r){return e&&C(i.prototype,e),r&&C(i,r),i}function p(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),e&&l(i,e)}function l(i,e){return l=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},l(i,e)}function a(i){var e=g();return function(){var r=h(i);if(e){var n=h(this).constructor;r=Reflect.construct(r,arguments,n)}else r=r.apply(this,arguments);return r=!r||S(r)!=="object"&&typeof r!="function"?f(this):r,r}}function f(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function g(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function h(i){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(i)}function s(i,e,r){return e in i?Object.defineProperty(i,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[e]=r,i}y=(function(i){function e(n){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var t=r.call(this);return s(f(t),"_array",void 0),s(f(t),"_size",void 0),t._array=n,t._size=n.length,t._isInitialized=!0,t}p(e,i);var r=a(e);return T(e,[{key:"init",value:function(n){setTimeout(n.onSuccess,0)}},{key:"loadRange",value:function(n,t){setTimeout(t.onSuccess,0)}},{key:"getByteAt",value:function(n){if(n>=this._array.length)throw Error("Offset "+n+" hasn't been loaded yet.");return this._array[n]}}],[{key:"canReadFile",value:function(n){return Array.isArray(n)||typeof Buffer=="function"&&Buffer.isBuffer(n)}}]),e})(y("./MediaFileReader")),m.exports=y},{"./MediaFileReader":11}],4:[function(y,m,R){function S(e){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},S(e)}function C(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function T(e,r,n){return r&&C(e.prototype,r),n&&C(e,n),e}function p(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&l(e,r)}function l(e,r){return l=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},l(e,r)}function a(e){var r=g();return function(){var n=h(e);if(r){var t=h(this).constructor;n=Reflect.construct(n,arguments,t)}else n=n.apply(this,arguments);return n=!n||S(n)!=="object"&&typeof n!="function"?f(this):n,n}}function f(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},h(e)}function s(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var i=y("./ChunkedFileData");y=(function(e){function r(t){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");var o=n.call(this);return s(f(o),"_blob",void 0),s(f(o),"_fileData",void 0),o._blob=t,o._fileData=new i,o}p(r,e);var n=a(r);return T(r,[{key:"_init",value:function(t){this._size=this._blob.size,setTimeout(t.onSuccess,1)}},{key:"loadRange",value:function(t,o){var u=this,c=(this._blob.slice||this._blob.mozSlice||this._blob.webkitSlice).call(this._blob,t[0],t[1]+1),d=new FileReader;d.onloadend=function(v){v=new Uint8Array(d.result),u._fileData.addData(t[0],v),o.onSuccess()},d.onerror=d.onabort=function(v){o.onError&&o.onError({type:"blob",info:d.error})},d.readAsArrayBuffer(c)}},{key:"getByteAt",value:function(t){return this._fileData.getByteAt(t)}}],[{key:"canReadFile",value:function(t){return typeof Blob<"u"&&t instanceof Blob||typeof File<"u"&&t instanceof File}}]),r})(y("./MediaFileReader")),m.exports=y},{"./ChunkedFileData":5,"./MediaFileReader":11}],5:[function(y,m,R){function S(T,p){for(var l=0;l<p.length;l++){var a=p[l];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(T,a.key,a)}}function C(T,p,l){return p&&S(T.prototype,p),l&&S(T,l),T}y=(function(){function T(){if(!(this instanceof T))throw new TypeError("Cannot call a class as a function");"_fileData"in this?Object.defineProperty(this,"_fileData",{value:void 0,enumerable:!0,configurable:!0,writable:!0}):this._fileData=void 0,this._fileData=[]}return C(T,[{key:"addData",value:function(p,l){var a=p+l.length-1,f=this._getChunkRange(p,a);if(f.startIx===-1)this._fileData.splice(f.insertIx||0,0,{offset:p,data:l});else{var g=this._fileData[f.startIx],h=this._fileData[f.endIx];a=a<h.offset+h.data.length-1;var s={offset:Math.min(p,g.offset),data:l};p>g.offset&&(p=this._sliceData(g.data,0,p-g.offset),s.data=this._concatData(p,l)),a&&(p=this._sliceData(s.data,0,h.offset-s.offset),s.data=this._concatData(p,h.data)),this._fileData.splice(f.startIx,f.endIx-f.startIx+1,s)}}},{key:"_concatData",value:function(p,l){if(typeof ArrayBuffer<"u"&&ArrayBuffer.isView&&ArrayBuffer.isView(p)){var a=new p.constructor(p.length+l.length);return a.set(p,0),a.set(l,p.length),a}return p.concat(l)}},{key:"_sliceData",value:function(p,l,a){return p.slice?p.slice(l,a):p.subarray(l,a)}},{key:"_getChunkRange",value:function(p,l){for(var a,f,g=-1,h=-1,s=0,i=0;i<this._fileData.length&&(f=this._fileData[i].offset,a=f+this._fileData[i].data.length,!(l<f-1));i++,s=i)if(p<=a+1&&l>=f-1){g=i;break}if(g===-1)return{startIx:-1,endIx:-1,insertIx:s};for(i=g;i<this._fileData.length&&(f=this._fileData[i].offset,a=f+this._fileData[i].data.length,l>=f-1&&(h=i),!(l<=a+1));i++);return h===-1&&(h=g),{startIx:g,endIx:h}}},{key:"hasDataRange",value:function(p,l){for(var a=0;a<this._fileData.length;a++){var f=this._fileData[a];if(l<f.offset)break;if(p>=f.offset&&l<f.offset+f.data.length)return!0}return!1}},{key:"getByteAt",value:function(p){for(var l,a=0;a<this._fileData.length;a++){var f=this._fileData[a].offset,g=f+this._fileData[a].data.length-1;if(p>=f&&p<=g){l=this._fileData[a];break}}if(l)return l.data[p-l.offset];throw Error("Offset "+p+" hasn't been loaded yet.")}}],[{key:"NOT_FOUND",get:function(){return-1}}]),T})(),m.exports=y},{}],6:[function(y,m,R){function S(n){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(n)}function C(n,t){for(var o=0;o<t.length;o++){var u=t[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}function T(n,t,o){return t&&C(n.prototype,t),o&&C(n,o),n}function p(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&l(n,t)}function l(n,t){return l=Object.setPrototypeOf||function(o,u){return o.__proto__=u,o},l(n,t)}function a(n){var t=g();return function(){var o=h(n);if(t){var u=h(this).constructor;o=Reflect.construct(o,arguments,u)}else o=o.apply(this,arguments);return o=!o||S(o)!=="object"&&typeof o!="function"?f(this):o,o}}function f(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function g(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function h(n){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(n)}function s(n,t,o){return t in n?Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[t]=o,n}var i=[4,132],e=[6,134],r="Other;32x32 pixels 'file icon' (PNG only);Other file icon;Cover (front);Cover (back);Leaflet page;Media (e.g. label side of CD);Lead artist/lead performer/soloist;Artist/performer;Conductor;Band/Orchestra;Composer;Lyricist/text writer;Recording Location;During recording;During performance;Movie/video screen capture;A bright coloured fish;Illustration;Band/artist logotype;Publisher/Studio logotype".split(";");y=(function(n){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");for(var u=arguments.length,c=Array(u),d=0;d<u;d++)c[d]=arguments[d];return u=o.call.apply(o,[this].concat(c)),s(f(u),"_commentOffset",void 0),s(f(u),"_pictureOffset",void 0),u}p(t,n);var o=a(t);return T(t,[{key:"_loadData",value:function(u,c){var d=this;u.loadRange([4,7],{onSuccess:function(){d._loadBlock(u,4,c)}})}},{key:"_loadBlock",value:function(u,c,d){var v=this,_=u.getByteAt(c),A=u.getInteger24At(c+1,!0);if(i.indexOf(_)!==-1){var O=c+4;u.loadRange([O,O+A],{onSuccess:function(){v._commentOffset=O,v._nextBlock(u,c,_,A,d)}})}else e.indexOf(_)!==-1?(O=c+4,u.loadRange([O,O+A],{onSuccess:function(){v._pictureOffset=O,v._nextBlock(u,c,_,A,d)}})):v._nextBlock(u,c,_,A,d)}},{key:"_nextBlock",value:function(u,c,d,v,_){var A=this;127<d?A._commentOffset?_.onSuccess():_.onError({type:"loadData",info:"Comment block could not be found."}):u.loadRange([c+4+v,c+4+4+v],{onSuccess:function(){A._loadBlock(u,c+4+v,_)}})}},{key:"_parseData",value:function(u,c){var d=u.getLongAt(this._commentOffset,!1)+(this._commentOffset+4);c=u.getLongAt(d,!1),d+=4;for(var v,_,A,O,k,E,P=0;P<c;P++){var B=u.getLongAt(d,!1),b=u.getStringWithCharsetAt(d+4,B,"utf-8").toString(),j=b.indexOf("=");switch(b=[b.slice(0,j),b.slice(j+1)],b[0].toUpperCase()){case"TITLE":v=b[1];break;case"ARTIST":_=b[1];break;case"ALBUM":A=b[1];break;case"TRACKNUMBER":O=b[1];break;case"GENRE":k=b[1]}d+=4+B}return this._pictureOffset&&(E=u.getLongAt(this._pictureOffset,!0),c=this._pictureOffset+4,d=u.getLongAt(c,!0),P=c+4,c=u.getStringAt(P,d),d=P+d,P=u.getLongAt(d,!0),B=d+4,d=u.getStringWithCharsetAt(B,P,"utf-8").toString(),P=B+P+16,B=u.getLongAt(P,!0),u=u.getBytesAt(P+4,B,!0),E={format:c,type:r[E],description:d,data:u}),{type:"FLAC",version:"1",tags:{title:v,artist:_,album:A,track:O,genre:k,picture:E}}}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:4}}},{key:"canReadTagFormat",value:function(u){return String.fromCharCode.apply(String,u.slice(0,4))==="fLaC"}}]),t})(y("./MediaTagReader")),m.exports=y},{"./MediaTagReader":12}],7:[function(y,m,R){function S(s){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},S(s)}function C(s,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(s,r.key,r)}}function T(s,i,e){return i&&C(s.prototype,i),e&&C(s,e),s}function p(s,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(i&&i.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),i&&l(s,i)}function l(s,i){return l=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},l(s,i)}function a(s){var i=f();return function(){var e=g(s);if(i){var r=g(this).constructor;e=Reflect.construct(e,arguments,r)}else e=e.apply(this,arguments);if(!e||S(e)!=="object"&&typeof e!="function"){if(this===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=this}return e}}function f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function g(s){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},g(s)}R=y("./MediaTagReader"),y("./MediaFileReader"),y=(function(s){function i(){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");return e.apply(this,arguments)}p(i,s);var e=a(i);return T(i,[{key:"_loadData",value:function(r,n){var t=r.getSize();r.loadRange([t-128,t-1],n)}},{key:"_parseData",value:function(r,n){var t=r.getSize()-128,o=r.getStringWithCharsetAt(t+3,30).toString(),u=r.getStringWithCharsetAt(t+33,30).toString(),c=r.getStringWithCharsetAt(t+63,30).toString(),d=r.getStringWithCharsetAt(t+93,4).toString(),v=r.getByteAt(t+97+28);if(n=r.getByteAt(t+97+29),v==0&&n!=0){var _="1.1";v=r.getStringWithCharsetAt(t+97,28).toString()}else _="1.0",v=r.getStringWithCharsetAt(t+97,30).toString(),n=0;return r=r.getByteAt(t+97+30),r={type:"ID3",version:_,tags:{title:o,artist:u,album:c,year:d,comment:v,genre:255>r?h[r]:""}},n&&(r.tags.track=n),r}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:-128,length:128}}},{key:"canReadTagFormat",value:function(r){return String.fromCharCode.apply(String,r.slice(0,3))==="TAG"}}]),i})(R);var h="Blues;Classic Rock;Country;Dance;Disco;Funk;Grunge;Hip-Hop;Jazz;Metal;New Age;Oldies;Other;Pop;R&B;Rap;Reggae;Rock;Techno;Industrial;Alternative;Ska;Death Metal;Pranks;Soundtrack;Euro-Techno;Ambient;Trip-Hop;Vocal;Jazz+Funk;Fusion;Trance;Classical;Instrumental;Acid;House;Game;Sound Clip;Gospel;Noise;AlternRock;Bass;Soul;Punk;Space;Meditative;Instrumental Pop;Instrumental Rock;Ethnic;Gothic;Darkwave;Techno-Industrial;Electronic;Pop-Folk;Eurodance;Dream;Southern Rock;Comedy;Cult;Gangsta;Top 40;Christian Rap;Pop/Funk;Jungle;Native American;Cabaret;New Wave;Psychadelic;Rave;Showtunes;Trailer;Lo-Fi;Tribal;Acid Punk;Acid Jazz;Polka;Retro;Musical;Rock & Roll;Hard Rock;Folk;Folk-Rock;National Folk;Swing;Fast Fusion;Bebob;Latin;Revival;Celtic;Bluegrass;Avantgarde;Gothic Rock;Progressive Rock;Psychedelic Rock;Symphonic Rock;Slow Rock;Big Band;Chorus;Easy Listening;Acoustic;Humour;Speech;Chanson;Opera;Chamber Music;Sonata;Symphony;Booty Bass;Primus;Porn Groove;Satire;Slow Jam;Club;Tango;Samba;Folklore;Ballad;Power Ballad;Rhythmic Soul;Freestyle;Duet;Punk Rock;Drum Solo;Acapella;Euro-House;Dance Hall".split(";");m.exports=y},{"./MediaFileReader":11,"./MediaTagReader":12}],8:[function(y,m,R){function S(s,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(s,r.key,r)}}function C(s,i,e){return e&&S(s,e),s}function T(s){switch(s){case 0:s="iso-8859-1";break;case 1:s="utf-16";break;case 2:s="utf-16be";break;case 3:s="utf-8";break;default:s="iso-8859-1"}return s}function p(s,i,e,r){var n=e.getStringWithCharsetAt(s+1,i-1,r);return s=e.getStringWithCharsetAt(s+1+n.bytesReadCount,i-1-n.bytesReadCount,r),{user_description:n.toString(),data:s.toString()}}y("./MediaFileReader");var l=y("./StringUtils"),a=y("./ArrayFileReader"),f={BUF:"Recommended buffer size",CNT:"Play counter",COM:"Comments",CRA:"Audio encryption",CRM:"Encrypted meta frame",ETC:"Event timing codes",EQU:"Equalization",GEO:"General encapsulated object",IPL:"Involved people list",LNK:"Linked information",MCI:"Music CD Identifier",MLL:"MPEG location lookup table",PIC:"Attached picture",POP:"Popularimeter",REV:"Reverb",RVA:"Relative volume adjustment",SLT:"Synchronized lyric/text",STC:"Synced tempo codes",TAL:"Album/Movie/Show title",TBP:"BPM (Beats Per Minute)",TCM:"Composer",TCO:"Content type",TCR:"Copyright message",TDA:"Date",TDY:"Playlist delay",TEN:"Encoded by",TFT:"File type",TIM:"Time",TKE:"Initial key",TLA:"Language(s)",TLE:"Length",TMT:"Media type",TOA:"Original artist(s)/performer(s)",TOF:"Original filename",TOL:"Original Lyricist(s)/text writer(s)",TOR:"Original release year",TOT:"Original album/Movie/Show title",TP1:"Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",TP2:"Band/Orchestra/Accompaniment",TP3:"Conductor/Performer refinement",TP4:"Interpreted, remixed, or otherwise modified by",TPA:"Part of a set",TPB:"Publisher",TRC:"ISRC (International Standard Recording Code)",TRD:"Recording dates",TRK:"Track number/Position in set",TSI:"Size",TSS:"Software/hardware and settings used for encoding",TT1:"Content group description",TT2:"Title/Songname/Content description",TT3:"Subtitle/Description refinement",TXT:"Lyricist/text writer",TXX:"User defined text information frame",TYE:"Year",UFI:"Unique file identifier",ULT:"Unsychronized lyric/text transcription",WAF:"Official audio file webpage",WAR:"Official artist/performer webpage",WAS:"Official audio source webpage",WCM:"Commercial information",WCP:"Copyright/Legal information",WPB:"Publishers official webpage",WXX:"User defined URL link frame",AENC:"Audio encryption",APIC:"Attached picture",ASPI:"Audio seek point index",CHAP:"Chapter",CTOC:"Table of contents",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQU2:"Equalisation (2)",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",GRID:"Group identification registration",IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVA2:"Relative volume adjustment (2)",RVAD:"Relative volume adjustment",RVRB:"Reverb",SEEK:"Seek frame",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",TCON:"Content type",TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TDRC:"Recording time",TDRL:"Release time",TDTG:"Tagging time",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIPL:"Involved people list",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMCL:"Musician credits list",TMED:"Media type",TMOO:"Mood",TOAL:"Original album/movie/show title",TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPRO:"Produced notice",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",TSOA:"Album sort order",TSOP:"Performer sort order",TSOT:"Title sort order",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TSST:"Set subtitle",TYER:"Year",TXXX:"User defined text information frame",UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"};y=(function(){function s(){if(!(this instanceof s))throw new TypeError("Cannot call a class as a function")}return C(s,null,[{key:"getFrameReaderFunction",value:function(i){return i in g?g[i]:i[0]==="T"?g["T*"]:i[0]==="W"?g["W*"]:null}},{key:"readFrames",value:function(i,e,r,n,t){for(var o={},u=this._getFrameHeaderSize(n);i<e-u;){var c=this._readFrameHeader(r,i,n),d=c.id;if(!d)break;var v=c.flags,_=c.size,A=i+c.headerSize,O=r;if(i+=c.headerSize+c.size,!t||t.indexOf(d)!==-1){if(d==="MP3e"||d==="\0MP3"||d==="\0\0MP"||d===" MP3")break;v&&v.format.unsynchronisation&&!n.flags.unsynchronisation&&(O=this.getUnsyncFileReader(O,A,_),A=0,_=O.getSize()),v&&v.format.data_length_indicator&&(A+=4,_-=4),v=(c=s.getFrameReaderFunction(d))?c.apply(this,[A,_,O,v,n]):null,A=this._getFrameDescription(d),_={id:d,size:_,description:A,data:v},d in o?(o[d].id&&(o[d]=[o[d]]),o[d].push(_)):o[d]=_}}return o}},{key:"_getFrameHeaderSize",value:function(i){return i=i.major,i==2?6:i==3||i==4?10:0}},{key:"_readFrameHeader",value:function(i,e,r){var n=r.major,t=null;switch(r=this._getFrameHeaderSize(r),n){case 2:var o=i.getStringAt(e,3),u=i.getInteger24At(e+3,!0);break;case 3:o=i.getStringAt(e,4),u=i.getLongAt(e+4,!0);break;case 4:o=i.getStringAt(e,4),u=i.getSynchsafeInteger32At(e+4)}return(o=="\0\0\0"||o=="\0\0\0\0")&&(o=""),o&&2<n&&(t=this._readFrameFlags(i,e+8)),{id:o||"",size:u||0,headerSize:r||0,flags:t}}},{key:"_readFrameFlags",value:function(i,e){return{message:{tag_alter_preservation:i.isBitSetAt(e,6),file_alter_preservation:i.isBitSetAt(e,5),read_only:i.isBitSetAt(e,4)},format:{grouping_identity:i.isBitSetAt(e+1,7),compression:i.isBitSetAt(e+1,3),encryption:i.isBitSetAt(e+1,2),unsynchronisation:i.isBitSetAt(e+1,1),data_length_indicator:i.isBitSetAt(e+1,0)}}}},{key:"_getFrameDescription",value:function(i){return i in f?f[i]:"Unknown"}},{key:"getUnsyncFileReader",value:function(i,e,r){for(i=i.getBytesAt(e,r),e=0;e<i.length-1;e++)i[e]===255&&i[e+1]===0&&i.splice(e+1,1);return new a(i)}}]),s})();var g={APIC:function(s,i,e,r,n){r=s;var t=T(e.getByteAt(s));switch(n&&n.major){case 2:n=e.getStringAt(s+1,3),s+=4;break;case 3:case 4:n=e.getStringWithCharsetAt(s+1,i-1),s+=1+n.bytesReadCount;break;default:throw Error("Couldn't read ID3v2 major version.")}var o=e.getByteAt(s);return o=h[o],t=e.getStringWithCharsetAt(s+1,i-(s-r)-1,t),s+=1+t.bytesReadCount,{format:n.toString(),type:o,description:t.toString(),data:e.getBytesAt(s,r+i-s)}},CHAP:function(s,i,e,r,n){r=s;var t={},o=l.readNullTerminatedString(e.getBytesAt(s,i));return t.id=o.toString(),s+=o.bytesReadCount,t.startTime=e.getLongAt(s,!0),s+=4,t.endTime=e.getLongAt(s,!0),s+=4,t.startOffset=e.getLongAt(s,!0),s+=4,t.endOffset=e.getLongAt(s,!0),s+=4,t.subFrames=this.readFrames(s,s+(i-(s-r)),e,n),t},CTOC:function(s,i,e,r,n){r=s;var t={childElementIds:[],id:void 0,topLevel:void 0,ordered:void 0,entryCount:void 0,subFrames:void 0},o=l.readNullTerminatedString(e.getBytesAt(s,i));for(t.id=o.toString(),s+=o.bytesReadCount,t.topLevel=e.isBitSetAt(s,1),t.ordered=e.isBitSetAt(s,0),s++,t.entryCount=e.getByteAt(s),s++,o=0;o<t.entryCount;o++){var u=l.readNullTerminatedString(e.getBytesAt(s,i-(s-r)));t.childElementIds.push(u.toString()),s+=u.bytesReadCount}return t.subFrames=this.readFrames(s,s+(i-(s-r)),e,n),t},COMM:function(s,i,e,r,n){var t=s,o=T(e.getByteAt(s));return r=e.getStringAt(s+1,3),n=e.getStringWithCharsetAt(s+4,i-4,o),s+=4+n.bytesReadCount,s=e.getStringWithCharsetAt(s,t+i-s,o),{language:r,short_description:n.toString(),text:s.toString()}}};g.COM=g.COMM,g.PIC=function(s,i,e,r,n){return g.APIC(s,i,e,r,n)},g.PCNT=function(s,i,e,r,n){return e.getLongAt(s,!1)},g.CNT=g.PCNT,g["T*"]=function(s,i,e,r,n){return r=T(e.getByteAt(s)),e.getStringWithCharsetAt(s+1,i-1,r).toString()},g.TXXX=function(s,i,e,r,n){return r=T(e.getByteAt(s)),p(s,i,e,r)},g.WXXX=function(s,i,e,r,n){return i===0?null:(r=T(e.getByteAt(s)),p(s,i,e,r))},g["W*"]=function(s,i,e,r,n){return i===0?null:e.getStringWithCharsetAt(s,i,"iso-8859-1").toString()},g.TCON=function(s,i,e,r){return g["T*"].apply(this,arguments).replace(/^\(\d+\)/,"")},g.TCO=g.TCON,g.USLT=function(s,i,e,r,n){var t=s,o=T(e.getByteAt(s));return r=e.getStringAt(s+1,3),n=e.getStringWithCharsetAt(s+4,i-4,o),s+=4+n.bytesReadCount,s=e.getStringWithCharsetAt(s,t+i-s,o),{language:r,descriptor:n.toString(),lyrics:s.toString()}},g.ULT=g.USLT,g.UFID=function(s,i,e,r,n){return r=l.readNullTerminatedString(e.getBytesAt(s,i)),s+=r.bytesReadCount,s=e.getBytesAt(s,i-r.bytesReadCount),{ownerIdentifier:r.toString(),identifier:s}};var h="Other;32x32 pixels 'file icon' (PNG only);Other file icon;Cover (front);Cover (back);Leaflet page;Media (e.g. label side of CD);Lead artist/lead performer/soloist;Artist/performer;Conductor;Band/Orchestra;Composer;Lyricist/text writer;Recording Location;During recording;During performance;Movie/video screen capture;A bright coloured fish;Illustration;Band/artist logotype;Publisher/Studio logotype".split(";");m.exports=y},{"./ArrayFileReader":3,"./MediaFileReader":11,"./StringUtils":13}],9:[function(y,m,R){function S(i){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(i)}function C(i,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function T(i,e,r){return e&&C(i.prototype,e),r&&C(i,r),i}function p(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),e&&l(i,e)}function l(i,e){return l=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},l(i,e)}function a(i){var e=f();return function(){var r=g(i);if(e){var n=g(this).constructor;r=Reflect.construct(r,arguments,n)}else r=r.apply(this,arguments);if(!r||S(r)!=="object"&&typeof r!="function"){if(this===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");r=this}return r}}function f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function g(i){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(i)}R=y("./MediaTagReader"),y("./MediaFileReader");var h=y("./ID3v2FrameReader");y=(function(i){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");return r.apply(this,arguments)}p(e,i);var r=a(e);return T(e,[{key:"_loadData",value:function(n,t){n.loadRange([6,9],{onSuccess:function(){n.loadRange([0,10+n.getSynchsafeInteger32At(6)-1],t)},onError:t.onError})}},{key:"_parseData",value:function(n,t){var o,u=0,c=n.getByteAt(u+3);if(4<c)return{type:"ID3",version:">2.4",tags:{}};var d=n.getByteAt(u+4),v=n.isBitSetAt(u+5,7),_=n.isBitSetAt(u+5,6),A=n.isBitSetAt(u+5,5),O=n.getSynchsafeInteger32At(u+6);if(u+=10,_)if(c===4){var k=n.getSynchsafeInteger32At(u);u+=k}else k=n.getLongAt(u,!0),u+=k+4;k={type:"ID3",version:"2."+c+"."+d,major:c,revision:d,flags:{unsynchronisation:v,extended_header:_,experimental_indicator:A,footer_present:!1},size:O,tags:{}},t&&(o=this._expandShortcutTags(t)),t=O+10,k.flags.unsynchronisation&&(n=h.getUnsyncFileReader(n,u,O),u=0,t=n.getSize()),n=h.readFrames(u,t,n,k,o);for(var E in s)s.hasOwnProperty(E)&&(o=this._getFrameData(n,s[E]))&&(k.tags[E]=o);for(var P in n)n.hasOwnProperty(P)&&(k.tags[P]=n[P]);return k}},{key:"_getFrameData",value:function(n,t){for(var o=0,u;u=t[o];o++)if(u in n)return n=n[u]instanceof Array?n[u][0]:n[u],n.data}},{key:"getShortcuts",value:function(){return s}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:10}}},{key:"canReadTagFormat",value:function(n){return String.fromCharCode.apply(String,n.slice(0,3))==="ID3"}}]),e})(R);var s={title:["TIT2","TT2"],artist:["TPE1","TP1"],album:["TALB","TAL"],year:["TYER","TYE"],comment:["COMM","COM"],track:["TRCK","TRK"],genre:["TCON","TCO"],picture:["APIC","PIC"],lyrics:["USLT","ULT"]};m.exports=y},{"./ID3v2FrameReader":8,"./MediaFileReader":11,"./MediaTagReader":12}],10:[function(y,m,R){function S(e){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},S(e)}function C(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function T(e,r,n){return r&&C(e.prototype,r),n&&C(e,n),e}function p(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&l(e,r)}function l(e,r){return l=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},l(e,r)}function a(e){var r=f();return function(){var n=g(e);if(r){var t=g(this).constructor;n=Reflect.construct(n,arguments,t)}else n=n.apply(this,arguments);if(!n||S(n)!=="object"&&typeof n!="function"){if(this===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");n=this}return n}}function f(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},g(e)}R=y("./MediaTagReader"),y("./MediaFileReader"),y=(function(e){function r(){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");return n.apply(this,arguments)}p(r,e);var n=a(r);return T(r,[{key:"_loadData",value:function(t,o){var u=this;t.loadRange([0,16],{onSuccess:function(){u._loadAtom(t,0,"",o)},onError:o.onError})}},{key:"_loadAtom",value:function(t,o,u,c){if(o>=t.getSize())c.onSuccess();else{var d=this,v=t.getLongAt(o,!0);if(v==0||isNaN(v))c.onSuccess();else{var _=t.getStringAt(o+4,4);if(this._isContainerAtom(_)){_=="meta"&&(o+=4);var A=(u?u+".":"")+_;A==="moov.udta.meta.ilst"?t.loadRange([o,o+v],c):t.loadRange([o+8,o+8+8],{onSuccess:function(){d._loadAtom(t,o+8,A,c)},onError:c.onError})}else t.loadRange([o+v,o+v+8],{onSuccess:function(){d._loadAtom(t,o+v,u,c)},onError:c.onError})}}}},{key:"_isContainerAtom",value:function(t){return 0<=["moov","udta","meta","ilst"].indexOf(t)}},{key:"_canReadAtom",value:function(t){return t!=="----"}},{key:"_parseData",value:function(t,o){var u={};o=this._expandShortcutTags(o),this._readAtom(u,t,0,t.getSize(),o);for(var c in i)i.hasOwnProperty(c)&&(o=u[i[c]])&&(u[c]=c==="track"?o.data.track:o.data);return{type:"MP4",ftyp:t.getStringAt(8,4),version:t.getLongAt(12,!0),tags:u}}},{key:"_readAtom",value:function(t,o,u,c,d,v,_){_=_===void 0?"":_+"  ";for(var A=u;A<u+c;){var O=o.getLongAt(A,!0);if(O==0)break;var k=o.getStringAt(A+4,4);if(this._isContainerAtom(k)){k=="meta"&&(A+=4),this._readAtom(t,o,A+8,O-8,d,(v?v+".":"")+k,_);break}(!d||0<=d.indexOf(k))&&v==="moov.udta.meta.ilst"&&this._canReadAtom(k)&&(t[k]=this._readMetadataAtom(o,A)),A+=O}}},{key:"_readMetadataAtom",value:function(t,o){var u=t.getLongAt(o,!0),c=t.getStringAt(o+4,4),d=t.getInteger24At(o+16+1,!0);if(d=h[d],c=="trkn")var v={track:t.getShortAt(o+16+10,!0),total:t.getShortAt(o+16+14,!0)};else if(c=="disk")v={disk:t.getShortAt(o+16+10,!0),total:t.getShortAt(o+16+14,!0)};else{o+=24;var _=u-24;switch(c==="covr"&&d==="uint8"&&(d="jpeg"),d){case"text":v=t.getStringWithCharsetAt(o,_,"utf-8").toString();break;case"uint8":v=t.getShortAt(o,!1);break;case"int":case"uint":v=(d=="int"?_==1?t.getSByteAt:_==2?t.getSShortAt:_==4?t.getSLongAt:t.getLongAt:_==1?t.getByteAt:_==2?t.getShortAt:t.getLongAt).call(t,o+(_==8?4:0),!0);break;case"jpeg":case"png":v={format:"image/"+d,data:t.getBytesAt(o,_)}}}return{id:c,size:u,description:s[c]||"Unknown",data:v}}},{key:"getShortcuts",value:function(){return i}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:16}}},{key:"canReadTagFormat",value:function(t){return String.fromCharCode.apply(String,t.slice(4,8))==="ftyp"}}]),r})(R);var h={0:"uint8",1:"text",13:"jpeg",14:"png",21:"int",22:"uint"},s={"©alb":"Album","©ART":"Artist",aART:"Album Artist","©day":"Release Date","©nam":"Title","©gen":"Genre",gnre:"Genre",trkn:"Track Number","©wrt":"Composer","©too":"Encoding Tool","©enc":"Encoded By",cprt:"Copyright",covr:"Cover Art","©grp":"Grouping",keyw:"Keywords","©lyr":"Lyrics","©cmt":"Comment",tmpo:"Tempo",cpil:"Compilation",disk:"Disc Number",tvsh:"TV Show Name",tven:"TV Episode ID",tvsn:"TV Season",tves:"TV Episode",tvnn:"TV Network",desc:"Description",ldes:"Long Description",sonm:"Sort Name",soar:"Sort Artist",soaa:"Sort Album",soco:"Sort Composer",sosn:"Sort Show",purd:"Purchase Date",pcst:"Podcast",purl:"Podcast URL",catg:"Category",hdvd:"HD Video",stik:"Media Type",rtng:"Content Rating",pgap:"Gapless Playback",apID:"Purchase Account",sfID:"Country Code",atID:"Artist ID",cnID:"Catalog ID",plID:"Collection ID",geID:"Genre ID","xid ":"Vendor Information",flvr:"Codec Flavor"},i={title:"©nam",artist:"©ART",album:"©alb",year:"©day",comment:"©cmt",track:"trkn",genre:"©gen",picture:"covr",lyrics:"©lyr"};m.exports=y},{"./MediaFileReader":11,"./MediaTagReader":12}],11:[function(y,m,R){function S(l,a){for(var f=0;f<a.length;f++){var g=a[f];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(l,g.key,g)}}function C(l,a,f){return a&&S(l.prototype,a),f&&S(l,f),l}function T(l,a,f){return a in l?Object.defineProperty(l,a,{value:f,enumerable:!0,configurable:!0,writable:!0}):l[a]=f,l}var p=y("./StringUtils");y=(function(){function l(a){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");T(this,"_isInitialized",void 0),T(this,"_size",void 0),this._isInitialized=!1,this._size=0}return C(l,[{key:"init",value:function(a){var f=this;if(this._isInitialized)setTimeout(a.onSuccess,1);else return this._init({onSuccess:function(){f._isInitialized=!0,a.onSuccess()},onError:a.onError})}},{key:"_init",value:function(a){throw Error("Must implement init function")}},{key:"loadRange",value:function(a,f){throw Error("Must implement loadRange function")}},{key:"getSize",value:function(){if(!this._isInitialized)throw Error("init() must be called first.");return this._size}},{key:"getByteAt",value:function(a){throw Error("Must implement getByteAt function")}},{key:"getBytesAt",value:function(a,f){for(var g=Array(f),h=0;h<f;h++)g[h]=this.getByteAt(a+h);return g}},{key:"isBitSetAt",value:function(a,f){return(this.getByteAt(a)&1<<f)!=0}},{key:"getSByteAt",value:function(a){return a=this.getByteAt(a),127<a?a-256:a}},{key:"getShortAt",value:function(a,f){return a=f?(this.getByteAt(a)<<8)+this.getByteAt(a+1):(this.getByteAt(a+1)<<8)+this.getByteAt(a),0>a&&(a+=65536),a}},{key:"getSShortAt",value:function(a,f){return a=this.getShortAt(a,f),32767<a?a-65536:a}},{key:"getLongAt",value:function(a,f){var g=this.getByteAt(a),h=this.getByteAt(a+1),s=this.getByteAt(a+2);return a=this.getByteAt(a+3),f=f?(((g<<8)+h<<8)+s<<8)+a:(((a<<8)+s<<8)+h<<8)+g,0>f&&(f+=4294967296),f}},{key:"getSLongAt",value:function(a,f){return a=this.getLongAt(a,f),2147483647<a?a-4294967296:a}},{key:"getInteger24At",value:function(a,f){var g=this.getByteAt(a),h=this.getByteAt(a+1);return a=this.getByteAt(a+2),f=f?((g<<8)+h<<8)+a:((a<<8)+h<<8)+g,0>f&&(f+=16777216),f}},{key:"getStringAt",value:function(a,f){for(var g=[],h=a,s=0;h<a+f;h++,s++)g[s]=String.fromCharCode(this.getByteAt(h));return g.join("")}},{key:"getStringWithCharsetAt",value:function(a,f,g){switch(a=this.getBytesAt(a,f),(g||"").toLowerCase()){case"utf-16":case"utf-16le":case"utf-16be":g=p.readUTF16String(a,g==="utf-16be");break;case"utf-8":g=p.readUTF8String(a);break;default:g=p.readNullTerminatedString(a)}return g}},{key:"getCharAt",value:function(a){return String.fromCharCode(this.getByteAt(a))}},{key:"getSynchsafeInteger32At",value:function(a){var f=this.getByteAt(a),g=this.getByteAt(a+1),h=this.getByteAt(a+2);return this.getByteAt(a+3)&127|(h&127)<<7|(g&127)<<14|(f&127)<<21}}],[{key:"canReadFile",value:function(a){throw Error("Must implement canReadFile function")}}]),l})(),m.exports=y},{"./StringUtils":13}],12:[function(y,m,R){function S(p,l){for(var a=0;a<l.length;a++){var f=l[a];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(p,f.key,f)}}function C(p,l,a){return l&&S(p.prototype,l),a&&S(p,a),p}function T(p,l,a){return l in p?Object.defineProperty(p,l,{value:a,enumerable:!0,configurable:!0,writable:!0}):p[l]=a,p}y("./MediaFileReader"),y=(function(){function p(l){if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");T(this,"_mediaFileReader",void 0),T(this,"_tags",void 0),this._mediaFileReader=l,this._tags=null}return C(p,[{key:"setTagsToRead",value:function(l){return this._tags=l,this}},{key:"read",value:function(l){var a=this;this._mediaFileReader.init({onSuccess:function(){a._loadData(a._mediaFileReader,{onSuccess:function(){try{var f=a._parseData(a._mediaFileReader,a._tags)}catch(g){if(l.onError){l.onError({type:"parseData",info:g.message});return}}l.onSuccess(f)},onError:l.onError})},onError:l.onError})}},{key:"getShortcuts",value:function(){return{}}},{key:"_loadData",value:function(l,a){throw Error("Must implement _loadData function")}},{key:"_parseData",value:function(l,a){throw Error("Must implement _parseData function")}},{key:"_expandShortcutTags",value:function(l){if(!l)return null;for(var a=[],f=this.getShortcuts(),g=0,h;h=l[g];g++)a=a.concat(f[h]||[h]);return a}}],[{key:"getTagIdentifierByteRange",value:function(){throw Error("Must implement")}},{key:"canReadTagFormat",value:function(l){throw Error("Must implement")}}]),p})(),m.exports=y},{"./MediaFileReader":11}],13:[function(y,m,R){function S(l,a){for(var f=0;f<a.length;f++){var g=a[f];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(l,g.key,g)}}function C(l,a,f){return a&&S(l.prototype,a),l}function T(l,a,f){return a in l?Object.defineProperty(l,a,{value:f,enumerable:!0,configurable:!0,writable:!0}):l[a]=f,l}var p=(function(){function l(a,f){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");T(this,"_value",void 0),T(this,"bytesReadCount",void 0),T(this,"length",void 0),this._value=a,this.bytesReadCount=f,this.length=a.length}return C(l,[{key:"toString",value:function(){return this._value}}]),l})();m.exports={readUTF16String:function(l,a,f){var g=0,h=1,s=0;f=Math.min(f||l.length,l.length),l[0]==254&&l[1]==255?(a=!0,g=2):l[0]==255&&l[1]==254&&(a=!1,g=2),a&&(h=0,s=1),a=[];for(var i=0;g<f;i++){var e=l[g+h],r=(e<<8)+l[g+s];if(g+=2,r==0)break;216>e||224<=e?a[i]=String.fromCharCode(r):(e=(l[g+h]<<8)+l[g+s],g+=2,a[i]=String.fromCharCode(r,e))}return new p(a.join(""),g)},readUTF8String:function(l,a){var f=0;a=Math.min(a||l.length,l.length),l[0]==239&&l[1]==187&&l[2]==191&&(f=3);for(var g=[],h=0;f<a;h++){var s=l[f++];if(s==0)break;if(128>s)g[h]=String.fromCharCode(s);else if(194<=s&&224>s){var i=l[f++];g[h]=String.fromCharCode(((s&31)<<6)+(i&63))}else if(224<=s&&240>s){i=l[f++];var e=l[f++];g[h]=String.fromCharCode(((s&255)<<12)+((i&63)<<6)+(e&63))}else if(240<=s&&245>s){i=l[f++],e=l[f++];var r=l[f++];e=((s&7)<<18)+((i&63)<<12)+((e&63)<<6)+(r&63)-65536,g[h]=String.fromCharCode((e>>10)+55296,(e&1023)+56320)}}return new p(g.join(""),f)},readNullTerminatedString:function(l,a){var f=[];a=a||l.length;for(var g=0;g<a;){var h=l[g++];if(h==0)break;f[g-1]=String.fromCharCode(h)}return new p(f.join(""),g)}}},{}],14:[function(y,m,R){function S(e){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},S(e)}function C(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function T(e,r,n){return r&&C(e.prototype,r),n&&C(e,n),e}function p(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&l(e,r)}function l(e,r){return l=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},l(e,r)}function a(e){var r=g();return function(){var n=h(e);if(r){var t=h(this).constructor;n=Reflect.construct(n,arguments,t)}else n=n.apply(this,arguments);return n=!n||S(n)!=="object"&&typeof n!="function"?f(this):n,n}}function f(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},h(e)}function s(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}var i=y("./ChunkedFileData");R=(function(e){function r(t){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");var o=n.call(this);return s(f(o),"_url",void 0),s(f(o),"_fileData",void 0),o._url=t,o._fileData=new i,o}p(r,e);var n=a(r);return T(r,[{key:"_init",value:function(t){r._config.avoidHeadRequests?this._fetchSizeWithGetRequest(t):this._fetchSizeWithHeadRequest(t)}},{key:"_fetchSizeWithHeadRequest",value:function(t){var o=this;this._makeXHRRequest("HEAD",null,{onSuccess:function(u){(u=o._parseContentLength(u))?(o._size=u,t.onSuccess()):o._fetchSizeWithGetRequest(t)},onError:t.onError})}},{key:"_fetchSizeWithGetRequest",value:function(t){var o=this,u=this._roundRangeToChunkMultiple([0,0]);this._makeXHRRequest("GET",u,{onSuccess:function(c){var d=o._parseContentRange(c);if(c=o._getXhrResponseContent(c),d){if(d.instanceLength==null){o._fetchEntireFile(t);return}o._size=d.instanceLength}else o._size=c.length;o._fileData.addData(0,c),t.onSuccess()},onError:t.onError})}},{key:"_fetchEntireFile",value:function(t){var o=this;this._makeXHRRequest("GET",null,{onSuccess:function(u){u=o._getXhrResponseContent(u),o._size=u.length,o._fileData.addData(0,u),t.onSuccess()},onError:t.onError})}},{key:"_getXhrResponseContent",value:function(t){return t.responseBody||t.responseText||""}},{key:"_parseContentLength",value:function(t){return t=this._getResponseHeader(t,"Content-Length"),t==null?t:parseInt(t,10)}},{key:"_parseContentRange",value:function(t){if(t=this._getResponseHeader(t,"Content-Range")){var o=t.match(/bytes (\d+)-(\d+)\/(?:(\d+)|\*)/i);if(!o)throw Error("FIXME: Unknown Content-Range syntax: "+t);return{firstBytePosition:parseInt(o[1],10),lastBytePosition:parseInt(o[2],10),instanceLength:o[3]?parseInt(o[3],10):null}}return null}},{key:"loadRange",value:function(t,o){var u=this;u._fileData.hasDataRange(t[0],Math.min(u._size,t[1]))?setTimeout(o.onSuccess,1):(t=this._roundRangeToChunkMultiple(t),t[1]=Math.min(u._size,t[1]),this._makeXHRRequest("GET",t,{onSuccess:function(c){c=u._getXhrResponseContent(c),u._fileData.addData(t[0],c),o.onSuccess()},onError:o.onError}))}},{key:"_roundRangeToChunkMultiple",value:function(t){return[t[0],t[0]+1024*Math.ceil((t[1]-t[0]+1)/1024)-1]}},{key:"_makeXHRRequest",value:function(t,o,u){var c=this._createXHRObject();c.open(t,this._url);var d=function(){c.status===200||c.status===206?u.onSuccess(c):u.onError&&u.onError({type:"xhr",info:"Unexpected HTTP status "+c.status+".",xhr:c}),c=null};typeof c.onload<"u"?(c.onload=d,c.onerror=function(){u.onError&&u.onError({type:"xhr",info:"Generic XHR error, check xhr object.",xhr:c})}):c.onreadystatechange=function(){c.readyState===4&&d()},r._config.timeoutInSec&&(c.timeout=1e3*r._config.timeoutInSec,c.ontimeout=function(){u.onError&&u.onError({type:"xhr",info:"Timeout after "+c.timeout/1e3+"s. Use jsmediatags.Config.setXhrTimeout to override.",xhr:c})}),c.overrideMimeType("text/plain; charset=x-user-defined"),o&&this._setRequestHeader(c,"Range","bytes="+o[0]+"-"+o[1]),this._setRequestHeader(c,"If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT"),c.send(null)}},{key:"_setRequestHeader",value:function(t,o,u){0>r._config.disallowedXhrHeaders.indexOf(o.toLowerCase())&&t.setRequestHeader(o,u)}},{key:"_hasResponseHeader",value:function(t,o){if(t=t.getAllResponseHeaders(),!t)return!1;t=t.split(`\r
`);for(var u=[],c=0;c<t.length;c++)u[c]=t[c].split(":")[0].toLowerCase();return 0<=u.indexOf(o.toLowerCase())}},{key:"_getResponseHeader",value:function(t,o){return this._hasResponseHeader(t,o)?t.getResponseHeader(o):null}},{key:"getByteAt",value:function(t){return this._fileData.getByteAt(t).charCodeAt(0)&255}},{key:"_isWebWorker",value:function(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}},{key:"_createXHRObject",value:function(){if(typeof window>"u"&&!this._isWebWorker())return new(y("xhr2")).XMLHttpRequest;if(typeof XMLHttpRequest<"u")return new XMLHttpRequest;throw Error("XMLHttpRequest is not supported")}}],[{key:"canReadFile",value:function(t){return typeof t=="string"&&/^[a-z]+:\/\//i.test(t)}},{key:"setConfig",value:function(t){for(var o in t)t.hasOwnProperty(o)&&(this._config[o]=t[o]);for(t=this._config.disallowedXhrHeaders,o=0;o<t.length;o++)t[o]=t[o].toLowerCase()}}]),r})(y("./MediaFileReader")),s(R,"_config",void 0),R._config={avoidHeadRequests:!1,disallowedXhrHeaders:[],timeoutInSec:30},m.exports=R},{"./ChunkedFileData":5,"./MediaFileReader":11,xhr2:2}],15:[function(y,m,R){function S(o,u){if(!(o instanceof u))throw new TypeError("Cannot call a class as a function")}function C(o,u){for(var c=0;c<u.length;c++){var d=u[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(o,d.key,d)}}function T(o,u,c){return u&&C(o.prototype,u),c&&C(o,c),o}function p(o,u,c){return u in o?Object.defineProperty(o,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[u]=c,o}function l(o,u){var c=0>o.offset&&(-o.offset>u||0<o.offset+o.length);return!(0<=o.offset&&o.offset+o.length>=u||c)}y("./MediaFileReader");var a=y("./XhrFileReader"),f=y("./BlobFileReader"),g=y("./ArrayFileReader");y("./MediaTagReader");var h=y("./ID3v1TagReader"),s=y("./ID3v2TagReader"),i=y("./MP4TagReader"),e=y("./FLACTagReader"),r=[],n=[],t=(function(){function o(u){S(this,o),p(this,"_file",void 0),p(this,"_tagsToRead",void 0),p(this,"_fileReader",void 0),p(this,"_tagReader",void 0),this._file=u}return T(o,[{key:"setTagsToRead",value:function(u){return this._tagsToRead=u,this}},{key:"setFileReader",value:function(u){return this._fileReader=u,this}},{key:"setTagReader",value:function(u){return this._tagReader=u,this}},{key:"read",value:function(u){var c=new(this._getFileReader())(this._file),d=this;c.init({onSuccess:function(){d._getTagReader(c,{onSuccess:function(v){new v(c).setTagsToRead(d._tagsToRead).read(u)},onError:u.onError})},onError:u.onError})}},{key:"_getFileReader",value:function(){return this._fileReader?this._fileReader:this._findFileReader()}},{key:"_findFileReader",value:function(){for(var u=0;u<r.length;u++)if(r[u].canReadFile(this._file))return r[u];throw Error("No suitable file reader found for "+this._file)}},{key:"_getTagReader",value:function(u,c){if(this._tagReader){var d=this._tagReader;setTimeout(function(){c.onSuccess(d)},1)}else this._findTagReader(u,c)}},{key:"_findTagReader",value:function(u,c){for(var d=[],v=[],_=u.getSize(),A=0;A<n.length;A++){var O=n[A].getTagIdentifierByteRange();l(O,_)&&(0<=O.offset&&O.offset<_/2||0>O.offset&&O.offset<-_/2?d.push(n[A]):v.push(n[A]))}var k=!1;A={onSuccess:function(){if(k){for(var E=0;E<n.length;E++){var P=n[E].getTagIdentifierByteRange();if(l(P,_)){try{var B=u.getBytesAt(0<=P.offset?P.offset:P.offset+_,P.length)}catch(b){c.onError&&c.onError({type:"fileReader",info:b.message});return}if(n[E].canReadTagFormat(B)){c.onSuccess(n[E]);return}}}c.onError&&c.onError({type:"tagFormat",info:"No suitable tag reader found"})}else k=!0},onError:c.onError},this._loadTagIdentifierRanges(u,d,A),this._loadTagIdentifierRanges(u,v,A)}},{key:"_loadTagIdentifierRanges",value:function(u,c,d){if(c.length===0)setTimeout(d.onSuccess,1);else{for(var v=[Number.MAX_VALUE,0],_=u.getSize(),A=0;A<c.length;A++){var O=c[A].getTagIdentifierByteRange(),k=0<=O.offset?O.offset:O.offset+_;O=k+O.length-1,v[0]=Math.min(k,v[0]),v[1]=Math.max(O,v[1])}u.loadRange(v,d)}}}]),o})();R=(function(){function o(){S(this,o)}return T(o,null,[{key:"addFileReader",value:function(u){return r.push(u),o}},{key:"addTagReader",value:function(u){return n.push(u),o}},{key:"removeTagReader",value:function(u){return u=n.indexOf(u),0<=u&&n.splice(u,1),o}},{key:"EXPERIMENTAL_avoidHeadRequests",value:function(){a.setConfig({avoidHeadRequests:!0})}},{key:"setDisallowedXhrHeaders",value:function(u){a.setConfig({disallowedXhrHeaders:u})}},{key:"setXhrTimeoutInSec",value:function(u){a.setConfig({timeoutInSec:u})}}]),o})(),R.addFileReader(a).addFileReader(f).addFileReader(g).addTagReader(s).addTagReader(h).addTagReader(i).addTagReader(e),typeof process>"u"||process.browser||(y=typeof navigator<"u"&&navigator.product==="ReactNative"?y("./ReactNativeFileReader"):y("./NodeFileReader"),R.addFileReader(y)),m.exports={read:function(o,u){new t(o).read(u)},Reader:t,Config:R}},{"./ArrayFileReader":3,"./BlobFileReader":4,"./FLACTagReader":6,"./ID3v1TagReader":7,"./ID3v2TagReader":9,"./MP4TagReader":10,"./MediaFileReader":11,"./MediaTagReader":12,"./NodeFileReader":1,"./ReactNativeFileReader":1,"./XhrFileReader":14}]},{},[15])(15)})})(M)),M.exports}var z=W();const X=N(z),q=U({__proto__:null,default:X},[z]);export{q as j};
